<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Task</title>
<style>
  body {
    font-family: monospace;
    max-width: 600px;
    margin: 40px auto;
    padding: 0 15px;
  }

  h1 {
    font-size: 20px;
    margin-bottom: 20px;
  }

  input, select, button {
    font-family: monospace;
    font-size: 14px;
  }

  #taskInput {
    width: 100%;
    margin-bottom: 5px;
  }

  #tagsInput {
    width: 100%;
    margin-bottom: 10px;
  }

  ul {
    list-style: none;
    padding: 0;
  }

  li {
    margin-bottom: 6px;
  }

  .completed span {
    text-decoration: line-through;
    opacity: 0.6;
  }

  button {
    margin-left: 5px;
  }
</style>
</head>
<body>

<h1>Task</h1>

<select id="prioritySelect">
  <option value="H">High (H)</option>
  <option value="M" selected>Medium (M)</option>
  <option value="L">Low (L)</option>
</select>

<input type="text" id="taskInput" placeholder="Task description" />
<input type="text" id="tagsInput" placeholder="Tags (comma separated)" />

<ul id="taskList"></ul>

<script>
const taskInput = document.getElementById('taskInput');
const tagsInput = document.getElementById('tagsInput');
const prioritySelect = document.getElementById('prioritySelect');
const taskList = document.getElementById('taskList');

let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

function saveTasks() {
  localStorage.setItem('tasks', JSON.stringify(tasks));
}

function createTask(text, priority, tags) {
  return {
    id: Date.now(),
    text: text.trim(),
    completed: false,
    priority: priority,
    tags: tags,
    createdAt: Date.now()
  };
}

function render() {
  taskList.innerHTML = '';

  tasks.forEach(task => {
    const li = document.createElement('li');
    if (task.completed) li.classList.add('completed');

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.checked = task.completed;
    checkbox.onclick = () => {
      task.completed = !task.completed;
      saveTasks();
      render();
    };

    const span = document.createElement('span');
    const tagText = task.tags.map(t => `#${t}`).join(' ');
    span.textContent = ` (${task.priority}) ${task.text}${tagText ? ' ' + tagText : ''}`;

    const delBtn = document.createElement('button');
    delBtn.textContent = 'x';
    delBtn.onclick = () => {
      tasks = tasks.filter(t => t.id !== task.id);
      saveTasks();
      render();
    };

    li.appendChild(checkbox);
    li.appendChild(span);
    li.appendChild(delBtn);

    taskList.appendChild(li);
  });
}

function addTask() {
  const text = taskInput.value.trim();
  if (!text) return;

  const tags = tagsInput.value
    .split(',')
    .map(t => t.trim())
    .filter(t => t !== '');

  const newTask = createTask(text, prioritySelect.value, tags);
  tasks.unshift(newTask);

  saveTasks();
  render();

  taskInput.value = '';
  tagsInput.value = '';
  taskInput.focus();
}

taskInput.addEventListener('keydown', e => {
  if (e.key === 'Enter') addTask();
});

render();
</script>

</body>
</html>
